<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstroTuff Dynamics Exoplanet Hunting</title>
    <meta name="color-scheme" content="dark light">
    <style>
      :root{
        --bg: #000;                 /* site background */
        --ink: #fff;                /* base text */
        --muted:#c7c7c7;            /* secondary text */
        --ink-weak:#9aa0a6;
        --panel:#0b0b0b;            /* panels */
        --line:#2b2b2b;             /* hairline */
        --banner:#1c4fa3;           /* top blue banner */
        --accent:#e24b3a;           /* AstroTuff Dynamics red button */
        --accent-2:#ff6b57;
        --focus:#ffd54a;

        --radius:14px;
        --pad:clamp(16px,2vw,24px);
        --maxw:1200px;

        --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Noto Sans", sans-serif;
      }

      /* ====== Base ====== */
      *,*::before,*::after{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0; font-family:var(--sans); color:var(--ink); background:var(--bg);
        -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
      }
      img{max-width:100%; display:block}
      a{color:inherit; text-decoration:none}
      a:focus-visible,button:focus-visible{outline:3px solid var(--focus); outline-offset:2px; border-radius:8px}
      .container{max-width:var(--maxw); margin:0 auto; padding-inline:var(--pad)}
      .visually-hidden{position:absolute!important; width:1px; height:1px; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; padding:0}

      /* ====== Government funding banner ====== */
      .banner{
        background:var(--banner); color:#fff; text-align:center; font-weight:700;
        padding:.6rem .8rem; font-size:.95rem;
      }
      .banner a{ text-decoration:underline }

      /* ====== Navbar ====== */
      header{border-bottom:1px solid var(--line); background:#0a0a0a}
      .nav{
        display:grid; align-items:center; grid-template-columns: 1fr auto 1fr;
        min-height:64px; gap:12px;
      }
      .left, .right{display:flex; align-items:center; gap:14px}
      .logo{
        width:38px; height:38px; border-radius:50%;
        background:
          radial-gradient(circle at 36% 34%, #fff 0 22%, transparent 23%),
          radial-gradient(circle at 65% 60%, #e24b3a 0 80%, #e24b3a 81% 100%);
        display:grid; place-items:center; border:2px solid #fff; justify-self:center;
      }
      .left a, .right a{color:#eaeaea; font-weight:600}
      .caret{display:inline-block; transform:translateY(-2px)}
      .search{
        display:flex; align-items:center; gap:8px; background:#121212; border:1px solid var(--line);
        border-radius:999px; padding:.45rem .65rem .45rem .6rem; min-width:220px;
      }
      .search input{
        background:transparent; border:none; color:#eaeaea; outline:none; width:100%;
      }
      .pill{display:inline-flex; align-items:center; gap:.4rem; padding:.4rem .65rem; background:#121212; border:1px solid var(--line); border-radius:999px}
      .live{font-size:.7rem; font-weight:900; color:#fff; background:#e24b3a; border-radius:6px; padding:.05rem .35rem; margin-left:6px}

      /* ====== Hero ====== */
      .hero{
        background:#000;
        padding: clamp(36px, 5vw, 64px) 0 clamp(28px, 4vw, 40px);
      }
      .hero-grid{
        display:grid; grid-template-columns: 1.2fr .8fr; gap:clamp(16px, 3vw, 40px); align-items:center;
      }
      @media (max-width: 980px){ .hero-grid{grid-template-columns:1fr} }
      .kicker{
        letter-spacing:.25em; text-transform:uppercase; color:var(--ink-weak);
        font-size:.8rem; font-weight:700; margin:0 0 .5rem;
      }
      h1{font-size: clamp(2.2rem, 6.5vw, 4.2rem); line-height:1.06; margin:.2rem 0 .8rem}
      .lead{color:#e0e0e0; font-size: clamp(1rem, 2.1vw, 1.25rem); max-width:40ch; margin-bottom:1.1rem}
      .cta{
        display:inline-block; background:linear-gradient(180deg,var(--accent),var(--accent-2));
        color:#fff; font-weight:800; border:none; padding:.9rem 1.1rem; border-radius:10px;
        box-shadow:0 8px 22px rgba(226,75,58,.35);
      }

      /* ====== Planet Explorer Specific Styles ====== */
      .subtitle {
        color: var(--muted);
        font-size: 1.1rem;
        margin-top: 0.5rem;
        text-align: center;
      }
      
      .search-section {
        margin: 2rem 0 3rem;
      }
      
      .input-group {
        display: flex;
        max-width: 600px;
        margin: 0 auto;
        gap: 12px;
        position: relative;
      }
      
      .input-group input {
        flex: 1;
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: 8px;
        padding: 0.85rem 1rem;
        color: var(--ink);
        font-size: 1rem;
      }
      
      .input-group button {
        background: linear-gradient(180deg, var(--accent), var(--accent-2));
        color: white;
        border: none;
        border-radius: 8px;
        padding: 0 1.5rem;
        font-weight: 700;
        cursor: pointer;
        white-space: nowrap;
      }
      
      .suggestions {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--panel);
        border: 1px solid var(--line);
        border-top: none;
        border-radius: 0 0 8px 8px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 10;
        display: none;
      }
      
      .suggestions.active {
        display: block;
      }
      
      .suggestion-item {
        padding: 0.75rem 1rem;
        cursor: pointer;
        border-bottom: 1px solid var(--line);
      }
      
      .suggestion-item:hover {
        background: rgba(255, 255, 255, 0.05);
      }
      
      .suggestion-item:last-child {
        border-bottom: none;
      }
      
      .planet-card, .error-card {
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: var(--radius);
        padding: 1.5rem;
        margin: 2rem 0;
      }
      
      .planet-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--line);
      }
      
      .planet-header h2 {
        margin: 0;
        font-size: 1.8rem;
      }
      
      .status-badge {
        padding: 0.4rem 0.8rem;
        border-radius: 999px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
      }
      
      .status-badge.planet {
        background: rgba(226, 75, 58, 0.2);
        color: var(--accent);
        border: 1px solid rgba(226, 75, 58, 0.4);
      }

      .status-badge.confirmed {
        background: rgba(76, 175, 80, 0.2);
        color: #4caf50;
        border: 1px solid rgba(76, 175, 80, 0.4);
      }

      .status-badge.highly-likely {
        background: rgba(33, 150, 243, 0.2);
        color: #2196f3;
        border: 1px solid rgba(33, 150, 243, 0.4);
      }

      .status-badge.likely {
        background: rgba(255, 193, 7, 0.2);
        color: #ffc107;
        border: 1px solid rgba(255, 193, 7, 0.4);
      }

      .status-badge.candidate {
        background: rgba(255, 152, 0, 0.2);
        color: #ff9800;
        border: 1px solid rgba(255, 152, 0, 0.4);
      }

      .status-badge.uncertain {
        background: rgba(158, 158, 158, 0.2);
        color: #9e9e9e;
        border: 1px solid rgba(158, 158, 158, 0.4);
      }

      .status-badge.false-positive {
        background: rgba(244, 67, 54, 0.2);
        color: #f44336;
        border: 1px solid rgba(244, 67, 54, 0.4);
      }
      
      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      
      .info-item {
        display: flex;
        justify-content: space-between;
        padding: 0.8rem 0;
        border-bottom: 1px solid var(--line);
      }
      
      .info-item label {
        color: var(--muted);
        font-weight: 600;
      }
      
      .info-item span {
        font-weight: 700;
      }
      
      .description h3 {
        margin-top: 0;
        margin-bottom: 0.8rem;
        font-size: 1.2rem;
      }
      
      .description p {
        line-height: 1.6;
        color: var(--muted);
      }
      
      .hidden {
        display: none;
      }
      
      .error-card {
        border-left: 4px solid var(--accent);
      }
      
      .error-card h3 {
        margin-top: 0;
        color: var(--accent);
      }
      
      footer {
        color: var(--ink-weak);
        border-top: 1px solid var(--line);
        padding: 24px 0 60px;
        text-align: center;
        margin-top: 2rem;
      }

      .moon {
        aspect-ratio: 1 / 1; 
        border-radius:999px; 
        margin-inline:auto; 
        width:min(500px, 80%);
        background:
          url('static/logo.png') center/cover no-repeat;
      }

      .rows{border-top:1px solid var(--line); margin-top:36px; padding-top:24px}
      .rowgrid{display:grid; gap:28px; grid-template-columns: repeat(3,1fr)}
      @media (max-width: 900px){ .rowgrid{grid-template-columns:1fr} }
      .row{
        position:relative; padding-top:16px;
        border-top:1px solid var(--line);
      }
      .eyebrow{font-size:.75rem; letter-spacing:.28em; color:var(--ink-weak); text-transform:uppercase}
      .row a{
        display:inline-flex; gap:.5rem; align-items:center; margin-top:.35rem; font-weight:800; color:#eaeaea;
      }
      .dot{width:8px; height:8px; background:#e24b3a; border-radius:50%}

      .notice{
        background:#fff; color:#111; border-radius:12px; padding:18px 20px; margin: clamp(18px,4vw,48px) auto;
        max-width: var(--maxw);
        box-shadow: 0 10px 24px rgba(0,0,0,.25);
      }
      .notice a{color:#0b57d0; text-decoration:underline}
      .notice strong{letter-spacing:.01em}

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255,255,255,.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .confidence-visualization {
        margin-top: 1rem;
      }
      
      .confidence-bar {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        overflow: hidden;
        height: 24px;
        width: 100%;
        position: relative;
      }
      
      .confidence-fill {
        background: linear-gradient(90deg, rgba(226, 75, 58, 1) 0%, rgba(255, 107, 87, 1) 100%);
        height: 100%;
        transition: width 0.4s ease;
        width: 0%;
      }
      
      .confidence-text {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        font-weight: 700;
        color: #fff;
        line-height: 24px;
        text-shadow: 0 1px 2px rgba(0,0,0,0.5);
      }
    </style>
</head>
<body>

<!-- Top funding banner -->
<p class="banner" role="status">
  AstroTuff Dynamics Exoplanet Hunting - Discover information about exoplanets discovered by NASA missions
</p>

<!-- Header / Nav -->
<header>
  <div class="container nav" role="navigation" aria-label="Primary">
    <div class="left">
      <strong>AstroTuff Dyanmics</strong>
    </div>
    <div class="right">
      <a href="https://docs.google.com/presentation/d/1LN-xdl16F7kjQ5OsflvH-wKTqFg98HotgMYPw9gB7yE/edit?usp=sharing">Presentation</a>
      <a href="#">Video</a>
      <a class="pill" href="https://github.com/alexsteinerr/hunting_exoplanets">GitHub</a>
    </div>
  </div>
</header>

<!-- Hero -->
<section class="hero">
  <div class="container hero-grid">
    <div>
      <p class="kicker">Exoplanet Archive</p>
      <h1>AstroTuff Dynamics Exoplanet Hunting</h1>
      <p class="lead">
        Discover detailed information about exoplanets discovered by NASA missions. Explore planetary characteristics, orbits, and scientific data from the NASA Exoplanet Archive.
      </p>
      <div class="search-section">
        <form id="planetForm">
          <div class="input-group">
            <input type="text" id="planetName" name="planet_name" placeholder="Search for an exoplanet (e.g., WASP-2 b)" required autocomplete="off">
            <button type="submit">Explore</button>
            <div id="suggestions" class="suggestions"></div>
          </div>
        </form>
      </div>
    </div>

    <div>
      <figure class="moon" role="img" aria-label="Phase of the Moon â€” placeholder image"></figure>
    </div>
  </div>

  <!-- Results Section -->
  <div class="container">
    <div id="resultSection" class="result-section hidden">
      <div class="planet-card">
        <div class="planet-header">
          <h2 id="planetTitle">Planet Name</h2>
          <span id="planetStatus" class="status-badge">Exoplanet</span>
        </div>
        
        <div class="planet-info">
          <div class="info-grid">
            <div class="info-item">
              <label>Host Star:</label>
              <span id="planetHost">-</span>
            </div>
            <div class="info-item">
              <label>TIC ID:</label>
              <span id="planetTicId">-</span>
            </div>
            <div class="info-item">
              <label>Orbital Period:</label>
              <span id="planetOrbit">-</span>
            </div>
            <div class="info-item">
              <label>Radius (Earth):</label>
              <span id="planetRadiusEarth">-</span>
            </div>
            <div class="info-item">
              <label>Radius (Jupiter):</label>
              <span id="planetRadiusJupiter">-</span>
            </div>
            <div class="info-item">
              <label>Transit Depth:</label>
              <span id="planetTransitDepth">-</span>
            </div>
            <div class="info-item">
              <label>Stellar Radius:</label>
              <span id="planetStellarRadius">-</span>
            </div>
            <div class="info-item">
              <label>Stellar Temperature:</label>
              <span id="planetStellarTemp">-</span>
            </div>
            <div class="info-item">
              <label>Distance:</label>
              <span id="planetDistance">-</span>
            </div>
          </div>
          
          <div class="description">
            <h3>Description</h3>
            <p id="planetDescription">-</p>
          </div>
        </div>
      </div>
    </div>

    <div id="errorSection" class="error-section hidden">
      <div class="error-card">
        <h3>Exoplanet Not Found</h3>
        <p>This exoplanet was not found in the AstroTuff Dynamics Exoplanet Archive database.</p>
        <p>Please try searching for another exoplanet name.</p>
      </div>
    </div>
  </div>

  <!-- ML Analysis Results Section -->
  <div id="mlAnalysisSection" class="hidden">
    <div class="container">
      <div class="planet-card">
        <div class="planet-header">
          <h2>ðŸ¤– ML Analysis Results</h2>
          <span id="mlStatus" class="status-badge">ANALYZING</span>
        </div>
        <div class="planet-info">
          <div class="info-grid">
            <div class="info-item">
              <label>Transit Detected:</label>
              <span id="mlTransitDetected">-</span>
            </div>
            <div class="info-item">
              <label>Confidence Score:</label>
              <span id="mlConfidence">-</span>
            </div>
            <div class="info-item">
              <label>Agreement Percentage:</label>
              <span id="mlAgreement">-</span>
            </div>
            <div class="info-item">
              <label>Model Used:</label>
              <span id="mlModel">-</span>
            </div>
          </div>
          <div class="description">
            <h3>Classification</h3>
            <p id="mlClassification">-</p>
          </div>
          <div class="confidence-visualization">
            <h3>Detection Confidence</h3>
            <div class="confidence-bar">
              <div class="confidence-fill" id="confidenceFill"></div>
              <span class="confidence-text" id="confidenceText">0%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Three link rows -->
  <div class="container rows">
    <div class="rowgrid">
      <div class="row">
        <div class="eyebrow">AstroTuff Dynamics Missions</div>
        <a href="https://exoplanetarchive.ipac.caltech.edu/cgi-bin/TblView/nph-tblView?app=ExoTbls&config=cumulative">TESS Data <span class="dot" aria-hidden="true"></span></a>
        <br>
        <a href="https://exoplanetarchive.ipac.caltech.edu/cgi-bin/TblView/nph-tblView?app=ExoTbls&config=TOI">Kepler Data <span class="dot" aria-hidden="true"></span></a>
      </div>
      <div class="row">
        <div class="eyebrow">Exoplanet Archive</div>
        <a href="https://exoplanetarchive.ipac.caltech.edu/">Full Database Access <span class="dot" aria-hidden="true"></span></a>
      </div>
      <div class="row">
        <div class="eyebrow">Education</div>
        <a href="https://science.AstroTuff Dynamics.gov/exoplanets/">Exoplanet Resources <span class="dot" aria-hidden="true"></span></a>
      </div>
    </div>
  </div>
</section>

<!-- Bottom white notice -->
<div class="notice" role="note" aria-live="polite">
  <strong>AstroTuff Dynamics Exoplanet Hunting</strong> is an educational tool providing information about exoplanets discovered by AstroTuff Dynamics missions. 
  Data is sourced from the NASA Exoplanet Archive at Caltech.
</div>

<footer>
  <div class="container">
    <p> AstroTuff Dynamics &copy; 2025 | AstroTuff Dynamics Exoplanet Hunting</p>
  </div>
</footer>

<script>
  // Debounce function to limit API calls
  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  // Fetch exoplanet data from your backend
  async function fetchExoplanetData(planetName) {
    try {
      console.log('Searching for planet:', planetName);
      const response = await fetch('/search', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'planet_name=' + encodeURIComponent(planetName)
      });
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const data = await response.json();
      console.log('API Response:', data);
      return data;
    } catch (error) {
      console.error('Error fetching exoplanet data:', error);
      return { error: error.message, is_planet: false };
    }
  }

  // Update ML analysis section with data
  function updateMLAnalysis(data) {
    console.log('Updating ML analysis with:', data);
    
    // Check if ML data exists
    if (data.transit_detected !== undefined || data.final_label !== undefined) {
      // Update ML analysis fields
      document.getElementById('mlTransitDetected').textContent = 
        data.transit_detected !== undefined ? (data.transit_detected ? 'Yes' : 'No') : '-';
      
      document.getElementById('mlConfidence').textContent = 
        data.transit_confidence !== undefined ? `${Number(data.transit_confidence).toFixed(1)}%` : '-';
      
      document.getElementById('mlAgreement').textContent = 
        data.agreement_score !== undefined ? `${Number(data.agreement_score).toFixed(1)}%` : '-';
      
      document.getElementById('mlModel').textContent = 
        data.model_used || data.analysis_status || '-';
      
      document.getElementById('mlClassification').textContent = 
        data.final_label || 'ANALYSIS_PENDING';
      
      // Update confidence visualization
      const confidencePercent = Number(data.transit_confidence).toFixed(1) || 0;
      document.getElementById('confidenceFill').style.width = `${confidencePercent}%`;
      document.getElementById('confidenceText').textContent = `${confidencePercent}%`;
      
      // Update ML status badge based on classification
      const mlStatus = document.getElementById('mlStatus');
      const finalLabel = data.final_label || 'ANALYZING';
      mlStatus.textContent = finalLabel.replace(/_/g, ' ');
      
      // Set appropriate class based on classification
      const classification = (finalLabel || '').toLowerCase();
      mlStatus.className = 'status-badge ' + getStatusClass(classification);
      
      // Show ML analysis section
      document.getElementById('mlAnalysisSection').classList.remove('hidden');
    } else {
      // Hide ML analysis section if no ML data
      document.getElementById('mlAnalysisSection').classList.add('hidden');
    }
  }

  // Helper function to get CSS class for status badge
  function getStatusClass(classification) {
    if (classification.includes('confirmed')) return 'confirmed';
    if (classification.includes('highly_likely') || classification.includes('highly likely')) return 'highly-likely';
    if (classification.includes('likely')) return 'likely';
    if (classification.includes('candidate')) return 'candidate';
    if (classification.includes('uncertain')) return 'uncertain';
    if (classification.includes('false')) return 'false-positive';
    return '';
  }

  // Fetch exoplanet suggestions while typing
  async function fetchSuggestions(query) {
    if (query.length < 2) {
      document.getElementById('suggestions').classList.remove('active');
      return;
    }
    
    try {
      const response = await fetch('/suggestions?q=' + encodeURIComponent(query));
      
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      
      const suggestions = await response.json();
      displaySuggestions(suggestions);
    } catch (error) {
      console.error('Error fetching suggestions:', error);
      // Fallback to mock suggestions if API fails
      displayMockSuggestions(query);
    }
  }

  // Display suggestions in the dropdown
  function displaySuggestions(suggestions) {
    const suggestionsContainer = document.getElementById('suggestions');
    suggestionsContainer.innerHTML = '';
    
    if (suggestions && suggestions.length > 0) {
      suggestions.forEach(suggestion => {
        const item = document.createElement('div');
        item.className = 'suggestion-item';
        item.textContent = suggestion;
        item.addEventListener('click', () => {
          document.getElementById('planetName').value = suggestion;
          suggestionsContainer.classList.remove('active');
          document.getElementById('planetForm').dispatchEvent(new Event('submit'));
        });
        suggestionsContainer.appendChild(item);
      });
      suggestionsContainer.classList.add('active');
    } else {
      suggestionsContainer.classList.remove('active');
    }
  }

  // Mock suggestions fallback
  function displayMockSuggestions(query) {
    const mockExoplanets = [
      "Kepler-186f", "Kepler-452b", "TRAPPIST-1e", "Proxima Centauri b", 
      "GJ 667 Cc", "HD 209458 b", "WASP-12b", "GJ 1214b", "HD 189733 b",
      "Kepler-22b", "Kepler-62f", "Kepler-438b", "LHS 1140 b", "K2-18b"
    ];
    
    const filtered = mockExoplanets.filter(name => 
      name.toLowerCase().includes(query.toLowerCase())
    );
    
    displaySuggestions(filtered);
  }

  // Initialize the application
  document.addEventListener('DOMContentLoaded', function() {
    const planetForm = document.getElementById('planetForm');
    const planetInput = document.getElementById('planetName');
    const suggestionsContainer = document.getElementById('suggestions');
    
    // Handle form submission
    planetForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      const planetName = planetInput.value.trim();
      
      if (!planetName) return;
      
      // Show loading state
      const submitButton = planetForm.querySelector('button[type="submit"]');
      const originalText = submitButton.textContent;
      submitButton.innerHTML = '<span class="loading"></span>';
      submitButton.disabled = true;
      
      // Hide previous results
      document.getElementById('resultSection').classList.add('hidden');
      document.getElementById('errorSection').classList.add('hidden');
      document.getElementById('mlAnalysisSection').classList.add('hidden');
      
      const data = await fetchExoplanetData(planetName);
      
      // Restore button state
      submitButton.textContent = originalText;
      submitButton.disabled = false;
      
      if (data.error) {
        // Show error
        document.getElementById('errorSection').classList.remove('hidden');
        console.error('API Error:', data.error);
      } else if (data.is_planet) {
        // Update planet information
        document.getElementById('planetTitle').textContent = data.name || planetName;
        document.getElementById('planetStatus').textContent = 'Exoplanet';
        document.getElementById('planetStatus').className = 'status-badge planet';
        document.getElementById('planetHost').textContent = data.hostname || '-';
        document.getElementById('planetTicId').textContent = data.tic_id || '-';
        document.getElementById('planetOrbit').textContent = data.period_days || '-';
        document.getElementById('planetRadiusEarth').textContent = data.radius_earth || '-';
        document.getElementById('planetRadiusJupiter').textContent = data.radius_jupiter || '-';
        document.getElementById('planetTransitDepth').textContent = data.transit_depth_ppm || '-';
        document.getElementById('planetStellarRadius').textContent = data.stellar_radius || '-';
        document.getElementById('planetStellarTemp').textContent = data.stellar_teff || '-';
        document.getElementById('planetDistance').textContent = data.distance_pc || '-';
        
        // Use provided description or generate one
        if (data.description) {
          document.getElementById('planetDescription').textContent = data.description;
        } else {
          let description = `${data.name || planetName} is an exoplanet`;
          if (data.hostname && data.hostname !== 'Unknown') description += ` orbiting the star ${data.hostname}`;
          if (data.period_days && data.period_days !== '-') description += ` with an orbital period of ${data.period_days}`;
          if (data.radius_earth && data.radius_earth !== '-') description += `. It has a radius of ${data.radius_earth}`;
          if (data.distance_pc && data.distance_pc !== '-') description += ` and is located approximately ${data.distance_pc} from Earth`;
          description += '.';
          document.getElementById('planetDescription').textContent = description;
        }
        
        document.getElementById('resultSection').classList.remove('hidden');
        
        // Update ML analysis section
        updateMLAnalysis(data);
      } else {
        // Planet not found
        document.getElementById('errorSection').classList.remove('hidden');
      }
      
      // Hide suggestions after search
      suggestionsContainer.classList.remove('active');
    });
    
    // Handle input for live search/suggestions
    planetInput.addEventListener('input', debounce(function() {
      const query = planetInput.value.trim();
      fetchSuggestions(query);
    }, 300));
    
    // Close suggestions when clicking outside
    document.addEventListener('click', function(e) {
      if (!planetInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
        suggestionsContainer.classList.remove('active');
      }
    });
    
    // Handle Enter key in search input
    planetInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        planetForm.dispatchEvent(new Event('submit'));
      }
    });
  });
</script>

</body>
</html>